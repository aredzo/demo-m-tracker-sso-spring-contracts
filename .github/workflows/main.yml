name: Build external contracts

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the main branch
on:
  push:
    branches: [ develop ]
  pull_request:
    branches: [ main, develop ]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest
    
    steps:
        - uses: actions/checkout@v2
        - name: Set up JDK 1.8
          uses: actions/setup-java@v1
          with:
            java-version: 1.8
        - name: Build with Maven
          run: mvn -B package --file pom.xml
        - name: Copy artifacts
          run: mkdir artifacts && cp target/*.jar artifacts && ls artifacts
        - name: Deploy to Bintray
          uses: simontunnat/action-maven-deploy@v1
          with:
            username: aredzo
            password: ${{ secrets.BINTRAY_KEY }}
            repository: https://api.bintray.com/maven/aredzo/mtracker/mtracker-sso-external/
